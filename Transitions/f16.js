(function() {
  this.f16 = {
    createFromComponent: function(component, additionalData, additionalUpdate) {
      var cloneData, mergeObjects, newComponentCopy, onUpdate;
      cloneData = JSON.parse(JSON.stringify(component.data));
      mergeObjects = function(objFrom, objTo) {
        var j, k, len, ref;
        ref = Object.keys(objFrom);
        for (j = 0, len = ref.length; j < len; j++) {
          k = ref[j];
          if (typeof objTo[k] !== 'object') {
            objTo[k] = objFrom[k];
          } else {
            if (typeof objFrom[k] === 'object') {
              mergeObjects(objFrom[k], objTo[k]);
            } else {
              objTo[k] = objFrom[k];
            }
          }
        }
        return objTo;
      };
      if (additionalData) {
        mergeObjects(additionalData, cloneData);
      }
      onUpdate = new Array;
      if (additionalUpdate) {
        onUpdate.push(additionalUpdate);
      }
      onUpdate.push(component.onUpdate);
      newComponentCopy = f16.createFromTemplate(component.template, cloneData, onUpdate, component.onCreated);
      return newComponentCopy;
    },
    createFromTemplate: function(template, data, onUpdate, onCreated) {
      /*
      for i in [0...this.children.length]
      try
          this.children[i].node.parentNode.removeChild this.children[i].node

      this.node.innerHTML = f16.processVars this.template, this.data
      for i in [0...this.children.length]
      this.node.appendChild this.children[i].node
      this.children[i].update()
      */
      var c, childrenToUpdate, f, j, l, len, n, newEl, newElobj, ref;
      newEl = template.cloneNode(true);
      newEl.removeAttribute('id');
      newEl.classList.toggle('hidden', false);
      newElobj = {
        type: 'f16',
        template: {
          node: newEl,
          nodesToUpdate: []
        },
        node: newEl,
        data: data,
        children: [],
        add: function(child) {
          var whereToPlace;
          this.children.push(child);
          if (child.placement) {
            whereToPlace = this.node.getElementsByTagName('levelTagPlacement')[0];
            whereToPlace.parentNode.insertBefore(child.node, whereToPlace);
          } else {
            this.node.appendChild(child.node);
          }
          return child.update();
        },
        addBefore: function(child) {
          this.children.unshift(child);
          this.node.insertBefore(child.node, this.node.children[0]);
          return child.update();
        },
        onUpdate: onUpdate,
        onCreated: onCreated,
        update: function() {
          var j, len, nodeToUpdate, ref, results;
          ref = this.template.nodesToUpdate;
          results = [];
          for (j = 0, len = ref.length; j < len; j++) {
            nodeToUpdate = ref[j];
            results.push(nodeToUpdate.node.nodeValue = f16.processVars(nodeToUpdate.template, this.data));
          }
          return results;
        }
      };
      childrenToUpdate = f16.parseChildNodes(newElobj.node);
      for (j = 0, len = childrenToUpdate.length; j < len; j++) {
        c = childrenToUpdate[j];
        n = {
          node: c,
          template: c.nodeValue
        };
        newElobj.template.nodesToUpdate.push(n);
      }
      
      //window[template.id] = template
      //if template.parentNode
      //    template.parentNode.removeChild template
      newElobj.node.parentREl = newElobj;
      newElobj.update();
      if (newElobj.onCreated) {
        newElobj.onCreated();
      }
      if (newElobj.onUpdate) {
        if (Array.isArray(newElobj.onUpdate)) {
          for (f = l = 0, ref = newElobj.onUpdate.length; (0 <= ref ? l < ref : l > ref); f = 0 <= ref ? ++l : --l) {
            newElobj.onUpdate[f] = newElobj.onUpdate[f].bind(newElobj);
            newElobj.onUpdate[f]();
          }
        } else {
          newElobj.onUpdate();
        }
      }
      watch(data, function() {
        var m, ref1, results;
        newElobj.data = data;
        newElobj.update();
        if (newElobj.onUpdate) {
          if (Array.isArray(newElobj.onUpdate)) {
            results = [];
            for (f = m = 0, ref1 = newElobj.onUpdate.length; (0 <= ref1 ? m < ref1 : m > ref1); f = 0 <= ref1 ? ++m : --m) {
              results.push(newElobj.onUpdate[f]());
            }
            return results;
          } else {
            return newElobj.onUpdate();
          }
        }
      });
      return newElobj;
    },
    parseChildNodes: function(node) {
      var child, childChild, childChilds, childs, j, l, len, len1, ref;
      childs = new Array;
      ref = node.childNodes;
      for (j = 0, len = ref.length; j < len; j++) {
        child = ref[j];
        if (child.nodeType === Node.TEXT_NODE) {
          childs.push(child);
        } else {
          if (child.hasChildNodes) {
            childChilds = f16.parseChildNodes(child);
            for (l = 0, len1 = childChilds.length; l < len1; l++) {
              childChild = childChilds[l];
              childs.push(childChild);
            }
          }
        }
      }
      return childs;
    },
    createIterator: function(parameters) {
      var i, j, newIterator, newObj, ref;
      newIterator = {
        parent: parameters.parent,
        template: parameters.template,
        data: parameters.data,
        onUpdate: parameters.onUpdate,
        onCreated: parameters.onCreated,
        children: [],
        update: function() {
          var checkDiff, i, j, l, newChild, newChildren, oldChildrenData, p, ref, ref1;
          newChildren = new Array;
          oldChildrenData = new Array;
          for (i = j = 0, ref = this.children.length; (0 <= ref ? j < ref : j > ref); i = 0 <= ref ? ++j : --j) {
            oldChildrenData.push(this.children[i].data);
          }
          checkDiff = f16.diff(oldChildrenData, this.data); // CHECK THE DIFFERENCE
          p = 0;
// NEUTRAL ELEMENT
          for (i = l = 0, ref1 = checkDiff.length; (0 <= ref1 ? l < ref1 : l > ref1); i = 0 <= ref1 ? ++l : --l) {
            if (checkDiff[i].action === ' ') {
              newChildren.push(this.children[checkDiff[i].oldPosition]);
            }
            if (checkDiff[i].action === '+') {
              if (checkDiff[i].isMoved === false) { // CREATE NEW ELEMENT
                newChild = f16.createFromTemplate(this.template, this.data[p], this.onUpdate, this.onCreated);
                try {
                  this.parent.insertBefore(newChild.node, this.children[p].node);
                } catch (error) {
                  this.parent.appendChild(newChild.node);
                }
                newChildren.push(newChild); // MOVE ELEMENT
              } else {
                if (newChildren[newChildren.length]) {
                  this.parent.insertBefore(this.children[checkDiff[i].isMoved].node, newChildren[newChildren.length].node);
                } else {
                  this.parent.appendChild(this.children[checkDiff[i].isMoved].node);
                }
                newChildren.push(this.children[checkDiff[i].isMoved]);
              }
            }
            if (checkDiff[i].action === '-') { // REMOVE ELEMENT
              this.parent.removeChild(this.children[checkDiff[i].position].node);
              p -= 1;
            }
            p += 1;
          }
          return this.children = newChildren;
        }
      };
      for (i = j = 0, ref = newIterator.data.length; (0 <= ref ? j < ref : j > ref); i = 0 <= ref ? ++j : --j) {
        newObj = this.createFromTemplate(newIterator.template, newIterator.data[i], newIterator.onUpdate, newIterator.onCreated);
        newIterator.parent.appendChild(newObj.node);
        newIterator.children.push(newObj);
      }
      watch(parameters.data, function() {
        return newIterator.update();
      });
      return newIterator;
    },
    diff: function(old, neu) {
      var D, M, MAX, N, V, delElement, elementsToDelete, elementsToMove, goDown, i, iRange, isMoved, j, k, l, m, newElement, o, offs, path, paths, ref, ref1, ref2, ref3, ref4, stayElement, x, y;
      isMoved = function(whatFind, whereFind) {
        var i, j, ref;
        for (i = j = 0, ref = whereFind.length; (0 <= ref ? j < ref : j > ref); i = 0 <= ref ? ++j : --j) {
          if (whatFind === whereFind[i]) {
            return i;
          }
        }
        return false;
      };
      N = old.length;
      M = neu.length;
      MAX = M + N;
      offs = MAX + 1;
      iRange = 2 * MAX;
      V = new Array;
      paths = new Array;
      elementsToMove = new Array;
      elementsToDelete = new Array;
      for (i = j = 0, ref = iRange; (0 <= ref ? j <= ref : j >= ref); i = 0 <= ref ? ++j : --j) {
        V.push(0);
      }
      for (i = l = 0, ref1 = iRange; (0 <= ref1 ? l <= ref1 : l >= ref1); i = 0 <= ref1 ? ++l : --l) {
        paths.push(new Array);
      }
      for (D = m = 0, ref2 = MAX; (0 <= ref2 ? m <= ref2 : m >= ref2); D = 0 <= ref2 ? ++m : --m) {
        for (k = o = ref3 = 0 - D, ref4 = D; o <= ref4; k = o += 2) {
          goDown = (k === (0 - D)) || ((k !== D) && (V[k - 1 + offs] < V[k + 1 + offs]));
          if (goDown) {
            x = V[k + 1 + offs];
            path = paths[k + 1 + offs].slice(0);
            y = x - k;
            if ((y > 0) && (y <= neu.length)) {
              newElement = new Object;
              newElement = {
                position: y - 1,
                action: '+',
                value: neu[y - 1],
                isMoved: isMoved(neu[y - 1], old)
              };
              path.push(newElement);
            }
          } else {
            x = V[k - 1 + offs] + 1;
            path = paths[k - 1 + offs].slice(0);
            if ((x > 0) && (x <= old.length)) {
              delElement = new Object;
              delElement = {
                position: x - 1,
                action: '-',
                value: old[x - 1],
                isMoved: isMoved(old[x - 1], neu)
              };
              path.push(delElement);
            }
          }
          y = x - k;
          while ((x < N) && (y < M) && (old[x] === neu[y])) {
            stayElement = new Object;
            stayElement = {
              oldPosition: x,
              position: y,
              action: ' ',
              value: neu[y]
            };
            path.push(stayElement);
            x += 1;
            y += 1;
          }
          V[k + offs] = x;
          paths[k + offs] = path;
          if (x >= N && y >= M) {
            return path;
          }
        }
      }
    },
    processVars: function(el, vars) {
      var allVars, i, j, r, ref;
      allVars = Object.keys(vars);
      for (i = j = 0, ref = allVars.length; (0 <= ref ? j < ref : j > ref); i = 0 <= ref ? ++j : --j) {
        r = new RegExp('{{' + allVars[i] + '}}', 'g');
        el = el.replace(r, vars[allVars[i]]);
      }
      return el;
    }
  };

}).call(this);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiPGFub255bW91cz4iXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFBQSxJQUFDLENBQUEsR0FBRCxHQUNJO0lBQUEsbUJBQUEsRUFBc0IsUUFBQSxDQUFDLFNBQUQsRUFBWSxjQUFaLEVBQTRCLGdCQUE1QixDQUFBO0FBQ2xCLFVBQUEsU0FBQSxFQUFBLFlBQUEsRUFBQSxnQkFBQSxFQUFBO01BQUEsU0FBQSxHQUFZLElBQUksQ0FBQyxLQUFMLENBQVcsSUFBSSxDQUFDLFNBQUwsQ0FBZSxTQUFTLENBQUMsSUFBekIsQ0FBWDtNQUVaLFlBQUEsR0FBZSxRQUFBLENBQUMsT0FBRCxFQUFVLEtBQVYsQ0FBQTtBQUNYLFlBQUEsQ0FBQSxFQUFBLENBQUEsRUFBQSxHQUFBLEVBQUE7QUFBQTtRQUFBLEtBQUEscUNBQUE7O1VBQ0ksSUFBRyxPQUFPLEtBQU0sQ0FBQSxDQUFBLENBQWIsS0FBbUIsUUFBdEI7WUFDSSxLQUFNLENBQUEsQ0FBQSxDQUFOLEdBQVcsT0FBUSxDQUFBLENBQUEsRUFEdkI7V0FBQSxNQUFBO1lBR0ksSUFBRyxPQUFPLE9BQVEsQ0FBQSxDQUFBLENBQWYsS0FBcUIsUUFBeEI7Y0FDSSxZQUFBLENBQWEsT0FBUSxDQUFBLENBQUEsQ0FBckIsRUFBeUIsS0FBTSxDQUFBLENBQUEsQ0FBL0IsRUFESjthQUFBLE1BQUE7Y0FHSSxLQUFNLENBQUEsQ0FBQSxDQUFOLEdBQVcsT0FBUSxDQUFBLENBQUEsRUFIdkI7YUFISjs7UUFESjtlQVNBO01BVlc7TUFZZixJQUFHLGNBQUg7UUFDSSxZQUFBLENBQWEsY0FBYixFQUE2QixTQUE3QixFQURKOztNQUlBLFFBQUEsR0FBVyxJQUFJO01BQ2YsSUFBa0MsZ0JBQWxDO1FBQUEsUUFBUSxDQUFDLElBQVQsQ0FBYyxnQkFBZCxFQUFBOztNQUNBLFFBQVEsQ0FBQyxJQUFULENBQWMsU0FBUyxDQUFDLFFBQXhCO01BRUEsZ0JBQUEsR0FBbUIsR0FBRyxD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QVUsR0FBSSxDQUFBLENBQUEsQ0FBZixDQUE5QjtZQUNJLFdBQUEsR0FBYyxJQUFJO1lBQ2xCLFdBQUEsR0FDSTtjQUFBLFdBQUEsRUFBYyxDQUFkO2NBQ0EsUUFBQSxFQUFXLENBRFg7Y0FFQSxNQUFBLEVBQVMsR0FGVDtjQUdBLEtBQUEsRUFBUSxHQUFJLENBQUEsQ0FBQTtZQUhaO1lBSUosSUFBSSxDQUFDLElBQUwsQ0FBVSxXQUFWO1lBRUEsQ0FBQSxJQUFLO1lBQ0wsQ0FBQSxJQUFLO1VBVlQ7VUFZQSxDQUFFLENBQUEsQ0FBQSxHQUFJLElBQUosQ0FBRixHQUFjO1VBQ2QsS0FBTSxDQUFBLENBQUEsR0FBSSxJQUFKLENBQU4sR0FBa0I7VUFHbEIsSUFBRyxDQUFBLElBQUssQ0FBTCxJQUFXLENBQUEsSUFBSyxDQUFuQjtBQUNJLG1CQUFPLEtBRFg7O1FBaERKO01BREo7SUF4QkcsQ0FwTVA7SUFrUkEsV0FBQSxFQUFjLFFBQUEsQ0FBQyxFQUFELEVBQUssSUFBTCxDQUFBO0FBQ1YsVUFBQSxPQUFBLEVBQUEsQ0FBQSxFQUFBLENBQUEsRUFBQSxDQUFBLEVBQUE7TUFBQSxPQUFBLEdBQVUsTUFBTSxDQUFDLElBQVAsQ0FBWSxJQUFaO01BRVYsS0FBUyx5RkFBVDtRQUNJLENBQUEsR0FBSSxJQUFJLE1BQUosQ0FBVyxJQUFBLEdBQU8sT0FBUSxDQUFBLENBQUEsQ0FBZixHQUFvQixJQUEvQixFQUFxQyxHQUFyQztRQUNKLEVBQUEsR0FBSyxFQUFFLENBQUMsT0FBSCxDQUFXLENBQVgsRUFBYyxJQUFLLENBQUEsT0FBUSxDQUFBLENBQUEsQ0FBUixDQUFuQjtNQUZUO2FBSUE7SUFQVTtFQWxSZDtBQURKIiwic291cmNlc0NvbnRlbnQiOlsiQGYxNiA9XG4gICAgY3JlYXRlRnJvbUNvbXBvbmVudCA6IChjb21wb25lbnQsIGFkZGl0aW9uYWxEYXRhLCBhZGRpdGlvbmFsVXBkYXRlKSAtPlxuICAgICAgICBjbG9uZURhdGEgPSBKU09OLnBhcnNlIEpTT04uc3RyaW5naWZ5IGNvbXBvbmVudC5kYXRhXG5cbiAgICAgICAgbWVyZ2VPYmplY3RzID0gKG9iakZyb20sIG9ialRvKSAtPlxuICAgICAgICAgICAgZm9yIGsgaW4gT2JqZWN0LmtleXMob2JqRnJvbSlcbiAgICAgICAgICAgICAgICBpZiB0eXBlb2Ygb2JqVG9ba10gIT0gJ29iamVjdCdcbiAgICAgICAgICAgICAgICAgICAgb2JqVG9ba10gPSBvYmpGcm9tW2tdXG4gICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICBpZiB0eXBlb2Ygb2JqRnJvbVtrXSA9PSAnb2JqZWN0J1xuICAgICAgICAgICAgICAgICAgICAgICAgbWVyZ2VPYmplY3RzIG9iakZyb21ba10sIG9ialRvW2tdXG4gICAgICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgICAgIG9ialRvW2tdID0gb2JqRnJvbVtrXVxuXG4gICAgICAgICAgICBvYmpUb1xuXG4gICAgICAgIGlmIGFkZGl0aW9uYWxEYXRhXG4gICAgICAgICAgICBtZXJnZU9iamVjdHMgYWRkaXRpb25hbERhdGEsIGNsb25lRGF0YVxuICAgICAgICAgICAgICAgIFxuXG4gICAgICAgIG9uVXBkYXRlID0gbmV3IEFycmF5XG4gICAgICAgIG9uVXBkYXRlLnB1c2ggYWRkaXRpb25hbFVwZGF0ZSBpZiBhZGRpdGlvbmFsVXBkYXRlXG4gICAgICAgIG9uVXBkYXRlLnB1c2ggY29tcG9uZW50Lm9uVXBkYXRlXG5cbiAgICAgICAgbmV3Q29tcG9uZW50Q29weSA9IGYxNi5jcmVhdGVGcm9tVGVtcGxhdGUgY29tcG9uZW50LnRlbXBsYXRlLCBjbG9uZURhdGEsIG9uVXBkYXRlLCBjb21wb25lbnQub25DcmVhdGVkXG4gICAgICAgIG5ld0NvbXBvbmVudENvcHlcbiAgICAgICAgXG5cbiAgICBjcmVhdGVGcm9tVGVtcGxhdGUgOiAodGVtcGxhdGUsIGRhdGEsIG9uVXBkYXRlLCBvbkNyZWF0ZWQpIC0+XG4gICAgICAgIG5ld0VsID0gdGVtcGxhdGUuY2xvbmVOb2RlIHRydWVcbiAgICAgICAgbmV3RWwucmVtb3ZlQXR0cmlidXRlICdpZCdcbiAgICAgICAgbmV3RWwuY2xhc3NMaXN0LnRvZ2dsZSAnaGlkZGVuJywgZmFsc2VcblxuICAgICAgICBuZXdFbG9iaiA9IFxuICAgICAgICAgICAgdHlwZSA6ICdmMTYnXG4gICAgICAgICAgICB0ZW1wbGF0ZSA6XG4gICAgICAgICAgICAgICAgbm9kZSA6IG5ld0VsXG4gICAgICAgICAgICAgICAgbm9kZXNUb1VwZGF0ZSA6IFtdXG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICBub2RlIDogbmV3RWxcbiAgICAgICAgICAgIGRhdGEgOiBkYXRhXG4gICAgICAgICAgICBjaGlsZHJlbiA6IFtdXG4gICAgICAgICAgICBhZGQgOiAoY2hpbGQpIC0+XG4gICAgICAgICAgICAgICAgdGhpcy5jaGlsZHJlbi5wdXNoIGNoaWxkXG5cbiAgICAgICAgICAgICAgICBpZiBjaGlsZC5wbGFjZW1lbnRcbiAgICAgICAgICAgICAgICAgICAgd2hlcmVUb1BsYWNlID0gdGhpcy5ub2RlLmdldEVsZW1lbnRzQnlUYWdOYW1lKCdsZXZlbFRhZ1BsYWNlbWVudCcpWzBdXG4gICAgICAgICAgICAgICAgICAgIHdoZXJlVG9QbGFjZS5wYXJlbnROb2RlLmluc2VydEJlZm9yZSBjaGlsZC5ub2RlLCB3aGVyZVRvUGxhY2VcbiAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgIHRoaXMubm9kZS5hcHBlbmRDaGlsZCBjaGlsZC5ub2RlXG5cbiAgICAgICAgICAgICAgICBjaGlsZC51cGRhdGUoKVxuICAgICAgICAgICAgXG4gICAgICAgICAgICBhZGRCZWZvcmUgOiAoY2hpbGQpIC0+XG4gICAgICAgICAgICAgICAgQGNoaWxkcmVuLnVuc2hpZnQgY2hpbGRcbiAgICAgICAgICAgICAgICBAbm9kZS5pbnNlcnRCZWZvcmUgY2hpbGQubm9kZSwgQG5vZGUuY2hpbGRyZW5bMF1cbiAgICAgICAgICAgICAgICBjaGlsZC51cGRhdGUoKVxuXG4gICAgICAgICAgICBvblVwZGF0ZSA6IG9uVXBkYXRlXG4gICAgICAgICAgICBvbkNyZWF0ZWQgOiBvbkNyZWF0ZWRcblxuICAgICAgICAgICAgdXBkYXRlIDogKCkgLT5cbiAgICAgICAgICAgICAgICBmb3Igbm9kZVRvVXBkYXRlIGluIHRoaXMudGVtcGxhdGUubm9kZXNUb1VwZGF0ZVxuICAgICAgICAgICAgICAgICAgICBub2RlVG9VcGRhdGUubm9kZS5ub2RlVmFsdWUgPSBmMTYucHJvY2Vzc1ZhcnMgbm9kZVRvVXBkYXRlLnRlbXBsYXRlLCB0aGlzLmRhdGFcbiAgICAgICAgICAgICAgICAjIyNcbiAgICAgICAgICAgICAgICBmb3IgaSBpbiBbMC4uLnRoaXMuY2hpbGRyZW4ubGVuZ3RoXVxuICAgICAgICAgICAgICAgICAgICB0cnlcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2hpbGRyZW5baV0ubm9kZS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkIHRoaXMuY2hpbGRyZW5baV0ubm9kZVxuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB0aGlzLm5vZGUuaW5uZXJIVE1MID0gZjE2LnByb2Nlc3NWYXJzIHRoaXMudGVtcGxhdGUsIHRoaXMuZGF0YVxuICAgICAgICAgICAgICAgIGZvciBpIGluIFswLi4udGhpcy5jaGlsZHJlbi5sZW5ndGhdXG4gICAgICAgICAgICAgICAgICAgIHRoaXMubm9kZS5hcHBlbmRDaGlsZCB0aGlzLmNoaWxkcmVuW2ldLm5vZGVcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jaGlsZHJlbltpXS51cGRhdGUoKVxuICAgICAgICAgICAgICAgICMjI1xuICAgICAgICBcbiAgICAgICAgY2hpbGRyZW5Ub1VwZGF0ZSA9IGYxNi5wYXJzZUNoaWxkTm9kZXMgbmV3RWxvYmoubm9kZVxuICAgICAgICBcbiAgICAgICAgZm9yIGMgaW4gY2hpbGRyZW5Ub1VwZGF0ZVxuICAgICAgICAgICAgbiA9XG4gICAgICAgICAgICAgICAgbm9kZSA6IGNcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZSA6IGMubm9kZVZhbHVlXG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICBuZXdFbG9iai50ZW1wbGF0ZS5ub2Rlc1RvVXBkYXRlLnB1c2ggblxuICAgICAgICBcbiAgICAgICAgXG4gICAgICAgICN3aW5kb3dbdGVtcGxhdGUuaWRdID0gdGVtcGxhdGVcbiAgICAgICAgI2lmIHRlbXBsYXRlLnBhcmVudE5vZGVcbiAgICAgICAgIyAgICB0ZW1wbGF0ZS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkIHRlbXBsYXRlXG5cbiAgICAgICAgbmV3RWxvYmoubm9kZS5wYXJlbnRSRWwgPSBuZXdFbG9ialxuICAgICAgICBuZXdFbG9iai51cGRhdGUoKVxuICAgICAgICBuZXdFbG9iai5vbkNyZWF0ZWQoKSBpZiBuZXdFbG9iai5vbkNyZWF0ZWRcblxuICAgICAgICBpZiBuZXdFbG9iai5vblVwZGF0ZVxuICAgICAgICAgICAgaWYgQXJyYXkuaXNBcnJheShuZXdFbG9iai5vblVwZGF0ZSlcbiAgICAgICAgICAgICAgICBmb3IgZiBpbiBbMC4uLm5ld0Vsb2JqLm9uVXBkYXRlLmxlbmd0aF1cbiAgICAgICAgICAgICAgICAgICAgbmV3RWxvYmoub25VcGRhdGVbZl0gPSBuZXdFbG9iai5vblVwZGF0ZVtmXS5iaW5kKG5ld0Vsb2JqKVxuICAgICAgICAgICAgICAgICAgICBuZXdFbG9iai5vblVwZGF0ZVtmXSgpXG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgbmV3RWxvYmoub25VcGRhdGUoKVxuXG4gICAgICAgIHdhdGNoIGRhdGEsICgpIC0+XG4gICAgICAgICAgICBuZXdFbG9iai5kYXRhID0gZGF0YVxuICAgICAgICAgICAgbmV3RWxvYmoudXBkYXRlKClcbiAgICAgICAgICAgIGlmIG5ld0Vsb2JqLm9uVXBkYXRlXG4gICAgICAgICAgICAgICAgaWYgQXJyYXkuaXNBcnJheShuZXdFbG9iai5vblVwZGF0ZSlcbiAgICAgICAgICAgICAgICAgICAgZm9yIGYgaW4gWzAuLi5uZXdFbG9iai5vblVwZGF0ZS5sZW5ndGhdXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdFbG9iai5vblVwZGF0ZVtmXSgpXG4gICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICBuZXdFbG9iai5vblVwZGF0ZSgpXG5cbiAgICAgICAgbmV3RWxvYmpcbiAgICBcbiAgICBcbiAgICBwYXJzZUNoaWxkTm9kZXMgOiAobm9kZSkgLT5cbiAgICAgICAgY2hpbGRzID0gbmV3IEFycmF5XG4gICAgICAgIFxuICAgICAgICBmb3IgY2hpbGQgaW4gbm9kZS5jaGlsZE5vZGVzXG4gICAgICAgICAgICBpZiBjaGlsZC5ub2RlVHlwZSA9PSBOb2RlLlRFWFRfTk9ERVxuICAgICAgICAgICAgICAgIGNoaWxkcy5wdXNoIGNoaWxkXG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgaWYgY2hpbGQuaGFzQ2hpbGROb2Rlc1xuICAgICAgICAgICAgICAgICAgICBjaGlsZENoaWxkcyA9IGYxNi5wYXJzZUNoaWxkTm9kZXMgY2hpbGRcbiAgICAgICAgICAgICAgICAgICAgZm9yIGNoaWxkQ2hpbGQgaW4gY2hpbGRDaGlsZHNcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkcy5wdXNoIGNoaWxkQ2hpbGRcbiAgICAgICAgXG4gICAgICAgIGNoaWxkc1xuICAgIFxuICAgIFxuICAgIGNyZWF0ZUl0ZXJhdG9yIDogKHBhcmFtZXRlcnMpIC0+XG4gICAgICAgIG5ld0l0ZXJhdG9yID1cbiAgICAgICAgICAgIHBhcmVudCA6IHBhcmFtZXRlcnMucGFyZW50XG4gICAgICAgICAgICB0ZW1wbGF0ZSA6IHBhcmFtZXRlcnMudGVtcGxhdGVcbiAgICAgICAgICAgIGRhdGEgOiBwYXJhbWV0ZXJzLmRhdGFcbiAgICAgICAgICAgIG9uVXBkYXRlIDogcGFyYW1ldGVycy5vblVwZGF0ZVxuICAgICAgICAgICAgb25DcmVhdGVkIDogcGFyYW1ldGVycy5vbkNyZWF0ZWRcbiAgICAgICAgICAgIGNoaWxkcmVuIDogW11cbiAgICAgICAgICAgIHVwZGF0ZSA6ICgpIC0+XG4gICAgICAgICAgICAgICAgbmV3Q2hpbGRyZW4gPSBuZXcgQXJyYXlcbiAgICAgICAgICAgICAgICBvbGRDaGlsZHJlbkRhdGEgPSBuZXcgQXJyYXlcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBmb3IgaSBpbiBbMC4uLnRoaXMuY2hpbGRyZW4ubGVuZ3RoXVxuICAgICAgICAgICAgICAgICAgICBvbGRDaGlsZHJlbkRhdGEucHVzaCB0aGlzLmNoaWxkcmVuW2ldLmRhdGFcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBjaGVja0RpZmYgPSBmMTYuZGlmZiBvbGRDaGlsZHJlbkRhdGEsIHRoaXMuZGF0YSAjIENIRUNLIFRIRSBESUZGRVJFTkNFXG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgcCA9IDBcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBmb3IgaSBpbiBbMC4uLmNoZWNrRGlmZi5sZW5ndGhdICAgICAgICAgICAgICAgICAjIE5FVVRSQUwgRUxFTUVOVFxuICAgICAgICAgICAgICAgICAgICBpZiBjaGVja0RpZmZbaV0uYWN0aW9uID09ICcgJ1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3Q2hpbGRyZW4ucHVzaCB0aGlzLmNoaWxkcmVuW2NoZWNrRGlmZltpXS5vbGRQb3NpdGlvbl1cbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgaWYgY2hlY2tEaWZmW2ldLmFjdGlvbiA9PSAnKydcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGNoZWNrRGlmZltpXS5pc01vdmVkID09IGZhbHNlICAgICAgICAjIENSRUFURSBORVcgRUxFTUVOVFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld0NoaWxkID0gZjE2LmNyZWF0ZUZyb21UZW1wbGF0ZSB0aGlzLnRlbXBsYXRlLCB0aGlzLmRhdGFbcF0sIHRoaXMub25VcGRhdGUsIHRoaXMub25DcmVhdGVkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGFyZW50Lmluc2VydEJlZm9yZSBuZXdDaGlsZC5ub2RlLCB0aGlzLmNoaWxkcmVuW3BdLm5vZGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXRjaFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBhcmVudC5hcHBlbmRDaGlsZCBuZXdDaGlsZC5ub2RlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3Q2hpbGRyZW4ucHVzaCBuZXdDaGlsZFxuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIyBNT1ZFIEVMRU1FTlRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBuZXdDaGlsZHJlbltuZXdDaGlsZHJlbi5sZW5ndGhdXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGFyZW50Lmluc2VydEJlZm9yZSB0aGlzLmNoaWxkcmVuW2NoZWNrRGlmZltpXS5pc01vdmVkXS5ub2RlLCBuZXdDaGlsZHJlbltuZXdDaGlsZHJlbi5sZW5ndGhdLm5vZGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGFyZW50LmFwcGVuZENoaWxkIHRoaXMuY2hpbGRyZW5bY2hlY2tEaWZmW2ldLmlzTW92ZWRdLm5vZGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdDaGlsZHJlbi5wdXNoIHRoaXMuY2hpbGRyZW5bY2hlY2tEaWZmW2ldLmlzTW92ZWRdXG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIGlmIGNoZWNrRGlmZltpXS5hY3Rpb24gPT0gJy0nICAgICAgICAgICAgICAgIyBSRU1PVkUgRUxFTUVOVFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wYXJlbnQucmVtb3ZlQ2hpbGQgdGhpcy5jaGlsZHJlbltjaGVja0RpZmZbaV0ucG9zaXRpb25dLm5vZGVcbiAgICAgICAgICAgICAgICAgICAgICAgIHAgLT0gMVxuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgcCArPSAxXG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgdGhpcy5jaGlsZHJlbiA9IG5ld0NoaWxkcmVuXG4gICAgICAgICAgICBcbiAgICAgICAgICAgIFxuICAgICAgICBmb3IgaSBpbiBbMC4uLm5ld0l0ZXJhdG9yLmRhdGEubGVuZ3RoXVxuICAgICAgICAgICAgbmV3T2JqID0gdGhpcy5jcmVhdGVGcm9tVGVtcGxhdGUgbmV3SXRlcmF0b3IudGVtcGxhdGUsIG5ld0l0ZXJhdG9yLmRhdGFbaV0sIG5ld0l0ZXJhdG9yLm9uVXBkYXRlLCBuZXdJdGVyYXRvci5vbkNyZWF0ZWRcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgbmV3SXRlcmF0b3IucGFyZW50LmFwcGVuZENoaWxkIG5ld09iai5ub2RlXG4gICAgICAgICAgICBcbiAgICAgICAgICAgIG5ld0l0ZXJhdG9yLmNoaWxkcmVuLnB1c2ggbmV3T2JqXG4gICAgICAgICAgICBcbiAgICAgICAgd2F0Y2ggcGFyYW1ldGVycy5kYXRhLCAoKSAtPlxuICAgICAgICAgICAgbmV3SXRlcmF0b3IudXBkYXRlKClcbiAgICAgICAgXG4gICAgICAgIG5ld0l0ZXJhdG9yXG4gICAgXG4gICAgXG4gICAgXG4gICAgZGlmZiA6IChvbGQsIG5ldSkgLT5cbiAgICAgICAgaXNNb3ZlZCA9ICh3aGF0RmluZCwgd2hlcmVGaW5kKSAtPlxuICAgICAgICAgICAgZm9yIGkgaW4gWzAuLi53aGVyZUZpbmQubGVuZ3RoXVxuICAgICAgICAgICAgICAgIGlmIHdoYXRGaW5kID09IHdoZXJlRmluZFtpXVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaVxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlXG5cbiAgICAgICAgTiA9IG9sZC5sZW5ndGhcbiAgICAgICAgTSA9IG5ldS5sZW5ndGhcbiAgICAgICAgTUFYID0gTSArIE5cbiAgICAgICAgb2ZmcyA9IE1BWCArIDFcblxuICAgICAgICBpUmFuZ2UgPSAyICogTUFYXG4gICAgICAgIFYgPSBuZXcgQXJyYXlcbiAgICAgICAgcGF0aHMgPSBuZXcgQXJyYXlcblxuICAgICAgICBlbGVtZW50c1RvTW92ZSA9IG5ldyBBcnJheVxuICAgICAgICBlbGVtZW50c1RvRGVsZXRlID0gbmV3IEFycmF5XG5cbiAgICAgICAgZm9yIGkgaW4gWzAuLmlSYW5nZV1cbiAgICAgICAgICAgIFYucHVzaCgwKVxuXG4gICAgICAgIHBhdGhzLnB1c2gobmV3IEFycmF5KSBmb3IgaSBpbiBbMC4uaVJhbmdlXVxuXG4gICAgICAgIGZvciBEIGluIFswLi5NQVhdXG4gICAgICAgICAgICBmb3IgayBpbiBbKDAgLSBEKS4uRF0gYnkgMlxuICAgICAgICAgICAgICAgIGdvRG93biA9IChrID09ICgwIC0gRCkpIHx8ICgoayAhPSBEKSAmJiAoVltrIC0gMSArIG9mZnNdIDwgVltrICsgMSArIG9mZnNdKSlcbiAgICAgICAgICAgICAgICBpZiBnb0Rvd25cbiAgICAgICAgICAgICAgICAgICAgeCA9IFZbayArIDEgKyBvZmZzXVxuICAgICAgICAgICAgICAgICAgICBwYXRoID0gcGF0aHNbayArIDEgKyBvZmZzXS5zbGljZSgwKVxuICAgICAgICAgICAgICAgICAgICB5ID0geCAtIGtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoeSA+IDApICYmICh5IDw9IG5ldS5sZW5ndGgpXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdFbGVtZW50ID0gbmV3IE9iamVjdFxuICAgICAgICAgICAgICAgICAgICAgICAgbmV3RWxlbWVudCA9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb24gOiB5IC0gMVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbiA6ICcrJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlIDogbmV1W3kgLSAxXVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzTW92ZWQgOiBpc01vdmVkKG5ldVt5IC0gMV0sIG9sZClcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhdGgucHVzaCBuZXdFbGVtZW50XG5cbiAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgIHggPSBWW2sgLSAxICsgb2Zmc10gKyAxXG5cbiAgICAgICAgICAgICAgICAgICAgcGF0aCA9IHBhdGhzW2sgLSAxICsgb2Zmc10uc2xpY2UoMClcblxuICAgICAgICAgICAgICAgICAgICBpZiAoeCA+IDApICYmICh4IDw9IG9sZC5sZW5ndGgpXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWxFbGVtZW50ID0gbmV3IE9iamVjdFxuICAgICAgICAgICAgICAgICAgICAgICAgZGVsRWxlbWVudCA9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb24gOiB4IC0gMVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbiA6ICctJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlIDogb2xkW3ggLSAxXVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzTW92ZWQgOiBpc01vdmVkKG9sZFt4IC0gMV0sIG5ldSlcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhdGgucHVzaCBkZWxFbGVtZW50XG5cbiAgICAgICAgICAgICAgICB5ID0geCAtIGtcblxuICAgICAgICAgICAgICAgIHdoaWxlICh4IDwgTikgYW5kICh5IDwgTSkgYW5kIChvbGRbeF0gPT0gbmV1W3ldKVxuICAgICAgICAgICAgICAgICAgICBzdGF5RWxlbWVudCA9IG5ldyBPYmplY3RcbiAgICAgICAgICAgICAgICAgICAgc3RheUVsZW1lbnQgPVxuICAgICAgICAgICAgICAgICAgICAgICAgb2xkUG9zaXRpb24gOiB4XG4gICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbiA6IHlcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbiA6ICcgJ1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgOiBuZXVbeV1cbiAgICAgICAgICAgICAgICAgICAgcGF0aC5wdXNoIHN0YXlFbGVtZW50XG5cbiAgICAgICAgICAgICAgICAgICAgeCArPSAxXG4gICAgICAgICAgICAgICAgICAgIHkgKz0gMVxuXG4gICAgICAgICAgICAgICAgVltrICsgb2Zmc10gPSB4XG4gICAgICAgICAgICAgICAgcGF0aHNbayArIG9mZnNdID0gcGF0aFxuXG5cbiAgICAgICAgICAgICAgICBpZiB4ID49IE4gYW5kIHkgPj0gTVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcGF0aFxuICAgIFxuICAgIFxuICAgIFxuICAgIHByb2Nlc3NWYXJzIDogKGVsLCB2YXJzKSAtPlxuICAgICAgICBhbGxWYXJzID0gT2JqZWN0LmtleXMgdmFyc1xuXG4gICAgICAgIGZvciBpIGluIFswLi4uYWxsVmFycy5sZW5ndGhdXG4gICAgICAgICAgICByID0gbmV3IFJlZ0V4cCAne3snICsgYWxsVmFyc1tpXSArICd9fScsICdnJ1xuICAgICAgICAgICAgZWwgPSBlbC5yZXBsYWNlIHIsIHZhcnNbYWxsVmFyc1tpXV1cblxuICAgICAgICBlbCJdfQ==
//# sourceURL=coffeescript